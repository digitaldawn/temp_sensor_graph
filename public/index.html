<!DOCTYPE HTML>
<html>

<head>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript">
  window.onload = function () {
  //$.getJSON( "/readings", function( data ) {

   /*  var dps= [
         {"x": 144739076700000,"y": 23.6}, 
          {"x": 144739077200000,"y": 23.7}, 
          {"x": 144739077600000,"y": 23.6}, 
          {"x": 144739078000000,"y": 23.6}];
          { x: 1088620200000, y :71},
          { x: 1104517800000, y : 55 },
          { x: 1112293800000, y:  50 },
          { x: 1136053800000, y : 65 },
          { x: 1157049000000, y : 95 },
          { x: 1162319400000, y : 68 },
          { x: 1180636200000, y : 28 },
          { x: 1193855400000, y : 34 },
          { x: 1209580200000, y : 14 },
          { x: 1230748200000, y : 34 },
          { x: 1241116200000, y : 44 }];*/
       var dps = [{"x":1447390767,"y":23.6}]; // dataPoints*/

    var chart = new CanvasJS.Chart("chartContainer",{
      title :{
        text: "Live Temperature"
      },      
      data: [{
        type: "line",
        //xValueType: “dateTime”,
        dataPoints: dps

                
      }]
    });

      //var xVal = 0;
      //var yVal = 100; 
    //var updateInterval = 1000;
    //var dataLength = 50; // number of dataPoints visible at any point
    var dataPoints = [];
    var dataSeries = { type: "line" };
    (function () {
        $.getJSON("/readings", function(thedata) {
            $.each(thedata, function(i, v) {
            dps.push({ x: new Date(v.Datetime), y: parseFloat(v.Value) });
            });
            chart.render();
            })

    })();

  //dataSeries.dataPoints = dataPoints;
  //dps.push(dataSeries);

  console.log(dps);
    
    /*var updateChart = function (count) {
      count = count || 1;
      // count is number of times loop runs to generate random dataPoints.
      
          /* for (var j = 0; j < count; j++) {  
            //yVal = yVal +  Math.round(5 + Math.random() *(-5-5));
        dps.push({
          x: xVal,
          y: yVal
        });
        xVal++;
                };
      if (dps.length > dataLength)
      {
        dps.shift();        
      }
      
      chart.render();   

    };

    // generates first set of dataPoints
    updateChart(dataLength); 

    // update chart after specified time. 
    setInterval(function(){updateChart()}, updateInterval); */
  
  

  }
  </script>
  <script type="text/javascript" src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>
</head>
<body>
  <h1>Temperature Readings <span>in</span> Last 24 Hours</h1>
  <div id="chartContainer" style="height: 300px; width:100%;">
  </div>
</body>
</html>
